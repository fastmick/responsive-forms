<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>responsive forms :: create account</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    <div class="main-wrapper">
        <h1>responsive forms</h1>
        <h2>create account</h2>

        <form class="form" id="form" action="" method="post">

            <fieldset>
                <div class="form__group">
                    <label for="" class="form__label" data-text="Nachname" data-text-orign="Nachname eingeben">
                        <span>Nachname eingeben</span>
                    </label>
                    <div class="form__input-wrapper">
                        <input class="form__input form__input--text" type="text" name="nachname" placeholder="Nachname eingeben" onfocus="this.placeholder = ''"
                            onblur="this.placeholder = 'Nachname eingeben'" required>
                    </div>
                    <em class="form__hint-text">Bitte wählen Sie ein Passwort mit mindestens 8 Zeichen.</em>
                </div>

                <div class="form__group">
                    <label for="" class="form__label" data-text="Vorname" data-text-orign="Vorname eingeben">
                        <span>Vorname eingeben</span>
                    </label>
                    <div class="form__input-wrapper">
                        <input class="form__input form__input--text" type="text" placeholder="Vorname eingeben" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Vorname eingeben'"
                            required>
                    </div>
                    <em class="form__hint-text">Bitte wählen Sie ein Passwort mit mindestens 8 Zeichen.</em>
                </div>
                <button>send</button>
            </fieldset>


        </form>





    </div>

    <script>



        (function () {
            $("input").focus(function () {
                $(this).addClass('active-input');
                $(this).parent().prev().addClass('show-label');
                $(this).parent().prev().fadeIn();
                $(this).parent().prev().css('display', 'block');

            });

            $("input").blur(function () {
                var labelText = $(this).parent().prev().data("text");
                var labelTextOrign = $(this).parent().prev().data("text-orign");

                $(this).removeClass('active-input');

                if ($(this).val() == "") {
                    $(this).parent().prev().removeClass('show-label');
                    $(this).parent().prev().fadeOut(0);
                    $(this).parent().prev().css('color', '#f00');
                    $(this).parent().prev().html('<span>' + labelTextOrign + '</span>');
                } else {
                    $(this).parent().prev().html('<span class="ok">' + labelText + '</span>');
                    $(this).parent().prev().css('color', '#000');
                }
            });



            $("button").click(function () {
                var invalidFields = $('form :invalid');
                var errorMessages = $('form .error-message');
                // console.log('invalidFields (jquery): '+invalidFields.length);
                // console.log('errorMessages (jquery): '+errorMessages.length);
                // console.log('invalidField 1 (jquery): '+invalidFields[ 1 ].validationMessage);
                // var elems = $('form').find(':invalid');

                for (var i = 0; i < errorMessages.length; i++) {
                    // console.log('remove: '+errorMessages.length);
                    var parentTag = $(errorMessages[i]).parent();
                    parentTag.children('.error-message').remove();
                }

                for (var i = 1; i < invalidFields.length; i++) {
                    // console.log('invalidField in for (jquery): '+invalidFields[ i ]);
                    var parentTag = $(invalidFields[i]).parent();
                    var errorMessage = invalidFields[i].validationMessage;
                    parentTag.append("<div class='error-message'>" + errorMessage + "</div>");
                }

                if (invalidFields.length > 0) {
                    console.log('form errors: ' + invalidFields.length);
                }
            });



        })();




        function replaceValidationUI(form) {
            // Suppress the default bubbles
            form.addEventListener("invalid", function (event) {
                event.preventDefault();
            }, true);

            // Support Safari, iOS Safari, and the Android browser—each of which do not prevent
            // form submissions by default
            form.addEventListener("submit", function (event) {
                if (!this.checkValidity()) {
                    event.preventDefault();
                }
            });

            // var submitButton = form.querySelector( "button:not([type=button]), input[type=submit]" );
            // submitButton.addEventListener( "click", function( event ) {
            //     var invalidFields = form.querySelectorAll( ":invalid" ),
            //         errorMessages = form.querySelectorAll( ".error-message" ),
            //         parent;
            //   	console.log('invalidFields: '+invalidFields.length);
            //     console.log('errorMessages: '+errorMessages.length);

            //   	// Remove any existing messages
            //     for ( var i = 0; i < errorMessages.length; i++ ) {
            //         errorMessages[ i ].parentNode.removeChild( errorMessages[ i ] );
            //     }


            //     for ( var i = 0; i < invalidFields.length; i++ ) {
            //         parent = invalidFields[ i ].parentNode;
            //       	parent.insertAdjacentHTML( "beforeend", "<div class='error-message'>" + 
            //             invalidFields[ i ].validationMessage +
            //             "</div>" );
            //     }

            //     // If there are errors, give focus to the first invalid field
            //     if ( invalidFields.length > 0 ) {
            //         invalidFields[ 0 ].focus();
            //     }
            // });
        }

        // Replace the validation UI for all forms
        var forms = document.querySelectorAll("form");
        for (var i = 0; i < forms.length; i++) {
            replaceValidationUI(forms[i]);
        }







        // var nachname = document.querySelector('input[name="nachname"]');
        // nachname.setCustomValidity('Bitte geben Sie Ihren Nachnamen ein!');

        // nachname.addEventListener('input', function () {
        //     // Note: if (this.checkValidity()) won't work
        //     // as setCustomValidity('with a message') will set
        //     // the field as invalid.
        //     if (this.value.trim() === '') {
        //         this.setCustomValidity('Bitte geben Sie Ihren Nachnamen ein!');
        //     }
        //     else {
        //         this.setCustomValidity('');
        //     }
        // }, false);

        // nachname.addEventListener('invalid', function () {
        //     if (this.value.trim() !== '') {
        //         this.setCustomValidity("'" + this.value + "' is not a valid name bro!");
        //     }
        // }, false);

        // document.querySelector( "input" ).addEventListener( "invalid",
        // function( event ) {
        //     event.preventDefault();
        // });

    </script>

</body>

</html>